# Frappe Themes Submodule

Un sub-repositorio independiente que contiene temas tanto para Website como para Frappe Desk. Incluye sistema completo de gesti√≥n de temas con previews, auto-cargador y theme switcher mejorado.

## üöÄ Caracter√≠sticas

- ‚ú® **Temas Website**: Temas "Dickface" y "Dickhead" con estilos Bootstrap personalizados
- üé® **Temas Desk**: "Dark Purple Desk" y "Ocean Blue Desk" para interfaz de escritorio
- üîß **Instalaci√≥n Autom√°tica**: Script que instala todo el sistema de temas
- üéØ **Theme Switcher Mejorado**: Cambio instant√°neo con previews visuales (Ctrl+Shift+G)
- ü§ñ **Auto-Cargador**: Persistencia autom√°tica de temas entre sesiones
- üìä **Theme Preview API**: Extracci√≥n autom√°tica de colores y variables CSS
- üì¶ **Sin Dependencias**: No requiere instalaciones adicionales
- ÔøΩÔ∏è **Plug & Play**: Funciona desde cualquier directorio frappe-bench
- üì± **Responsive**: Dise√±os adaptables y modernos

## üìÅ Estructura del Repositorio

```
frappe-themes-submodule/
‚îú‚îÄ‚îÄ themes/                              # Temas disponibles
‚îÇ   ‚îú‚îÄ‚îÄ dickface/                        # Website theme
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dickface.json               
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ dickhead/                        # Website theme
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dickhead.json               
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ dark_purple_desk/                # Desk theme
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dark_purple_desk.json       
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ ocean_blue_desk/                 # Desk theme
‚îÇ       ‚îú‚îÄ‚îÄ ocean_blue_desk.json        
‚îÇ       ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ utils/                               # Utilidades del sistema
‚îÇ   ‚îú‚îÄ‚îÄ theme_switcher_enhanced.js       # Theme switcher mejorado
‚îÇ   ‚îú‚îÄ‚îÄ desk.js                          # Auto-cargador integrado
‚îÇ   ‚îú‚îÄ‚îÄ theme_preview_api.py             # API de previews de temas
‚îÇ   ‚îî‚îÄ‚îÄ user_extension.py                # Gesti√≥n de preferencias
‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îî‚îÄ‚îÄ website_theme.json               # Fixtures para instalaci√≥n autom√°tica
‚îú‚îÄ‚îÄ install.sh                           # Script de instalaci√≥n principal
‚îú‚îÄ‚îÄ THEME_PREVIEW_API.md                 # Documentaci√≥n de la API
‚îî‚îÄ‚îÄ README.md                            # Este archivo
```

## üõ†Ô∏è Instalaci√≥n

### Opci√≥n 1: Como Subm√≥dulo Git (Recomendado)

```bash
# 1. Agregar como subm√≥dulo en tu proyecto
cd /path/to/frappe-bench
git submodule add [URL_DE_ESTE_REPO] frappe-themes-submodule

# 2. Instalar sistema completo de temas
./frappe-themes-submodule/install.sh mi_app

# 3. Migrar para aplicar cambios
bench --site mi-sitio migrate

# 4. Construir assets de Frappe
bench build --app frappe

# 5. Limpiar cache para aplicar tema switcher
bench --site mi-sitio clear-cache

# 6. ¬°Usar Ctrl+Shift+G para cambiar temas instantly!
```

### Opci√≥n 2: Descarga Directa

```bash
# 1. Descargar o clonar en frappe-bench
cd /path/to/frappe-bench
git clone [URL_DE_ESTE_REPO] themes-submodule

# 2. Ejecutar instalaci√≥n
./themes-submodule/install.sh mi_app

# 3. Migrar
bench --site mi-sitio migrate
```

### Opci√≥n 3: Descarga Manual

```bash
# 1. Descargar y extraer en frappe-bench
cd /path/to/frappe-bench
wget [URL_DEL_ZIP]
unzip frappe-themes-submodule.zip

# 2. Instalar
./frappe-themes-submodule/install.sh mi_app
```

## üîß Uso del Script de Instalaci√≥n

```bash
# Sintaxis b√°sica
./install.sh [nombre_de_tu_app]

# Ejemplo pr√°ctico
./install.sh dragon_ball_app
```

### ¬øQu√© instala el script?

1. **Verifica el entorno**: Confirma que est√°s en un directorio frappe-bench v√°lido
2. **Detecta m√≥dulo**: Lee autom√°ticamente el m√≥dulo correcto desde `modules.txt`
3. **Copia temas**: Instala todos los temas (website + desk) con configuraci√≥n autom√°tica
4. **Instala fixtures**: Copia y configura fixtures con m√≥dulo correcto
5. **Theme Switcher Mejorado**: Reemplaza el theme switcher de Frappe con versi√≥n enhanced
6. **Auto-Cargador de Temas**: Integra auto-loader en desk.js para persistencia autom√°tica
7. **Theme Preview API**: Instala endpoints para previews de temas con extracci√≥n de colores
8. **User Extensions**: A√±ade sistema de gesti√≥n de preferencias de usuario
9. **Backups**: Crea backups de archivos originales de Frappe
10. **Verifica instalaci√≥n**: Confirma que todo funciona correctamente

## üìã Requisitos

- ‚úÖ Frappe Framework v13+ 
- ‚úÖ Aplicaci√≥n Frappe v√°lida como destino
- ‚úÖ Permisos de escritura en el directorio `apps/`
- ‚úÖ Bash shell (Linux/macOS/WSL)

## üé® Temas Incluidos

### Website Themes
**Dickface Theme**
- Botones redondeados sin gradientes ni sombras
- Tipograf√≠a con pesos: 300-800
- Estilos Bootstrap personalizados

**Dickhead Theme**  
- Mismas caracter√≠sticas que Dickface
- Variaci√≥n de colores y espaciado

### Desk Themes (Nuevos!)
**Dark Purple Desk**
- Tema oscuro con acentos p√∫rpura elegantes
- Dise√±ado espec√≠ficamente para la interfaz Frappe Desk
- Colores: Background #1a1a2e, Accent #533483, Text #e6e6fa
- Optimizado para formularios, listas y m√≥dulos

**Ocean Blue Desk**
- Tema moderno con gradientes azul oc√©ano
- Animaciones suaves y efectos visuales enhanced
- Gradientes din√°micos y transiciones fluidas
- Perfecto para uso diario con excelente legibilidad

## üéõÔ∏è Sistema de Temas Mejorado

### Theme Switcher Enhanced (Ctrl+Shift+G)
- **Previews Visuales**: Ve c√≥mo se ver√° cada tema antes de aplicarlo
- **Aplicaci√≥n Instant√°nea**: Los temas se aplican inmediatamente sin refrescar
- **Detecci√≥n Inteligente**: Reconoce autom√°ticamente temas personalizados
- **Persistencia**: Guarda tu preferencia y la restaura autom√°ticamente

### Auto-Cargador Integrado
- **Carga Autom√°tica**: Tu tema favorito se carga autom√°ticamente al iniciar sesi√≥n
- **Sincronizaci√≥n**: Sincroniza preferencias entre diferentes dispositivos
- **Fallback Inteligente**: Sistema robusto de recuperaci√≥n ante errores

### Theme Preview API
- **Extracci√≥n de Colores**: Analiza autom√°ticamente CSS para generar previews
- **Variables CSS**: Detecta y mapea variables CSS personalizadas
- **Componentes**: Mapea colores espec√≠ficos para navbar, sidebar, botones, etc.
- **Validaci√≥n**: Sistema completo de validaci√≥n de colores y estilos

## üîÑ Actualizaci√≥n de Subm√≥dulo

```bash
# Actualizar a la √∫ltima versi√≥n
cd /path/to/frappe-bench
git submodule update --remote themes-submodule

# Reinstalar si hay cambios en temas
./themes-submodule/install.sh mi_app
bench --site mi-sitio migrate
```

## üêõ Soluci√≥n de Problemas

### Theme Switcher no aparece (Ctrl+Shift+G)

```bash
# 1. Verificar que se construyeron los assets
bench build --app frappe

# 2. Limpiar cach√© completamente  
bench --site mi-sitio clear-cache
bench --site mi-sitio clear-website-cache

# 3. Verificar que desk.js fue reemplazado
ls -la sites/assets/frappe/js/frappe/desk.js*

# 4. Refrescar el navegador completamente (Ctrl+F5)
```

### Los temas no aparecen en el Theme Switcher

```bash
# 1. Verificar que user_extension.py existe
ls apps/mi_app/mi_app/user_extension.py

# 2. Verificar import en __init__.py
grep "user_extension" apps/mi_app/mi_app/__init__.py

# 3. Probar API desde consola del navegador
frappe.xcall('mi_app.user_extension.get_available_themes')
```

### Los temas no se aplican o no persisten

```bash
# 1. Verificar Theme Preview API
frappe.xcall('mi_app.theme_preview_api.validate_theme_preview_api')

# 2. Verificar preferencias de usuario
frappe.xcall('mi_app.user_extension.get_desk_theme_preference')

# 3. Limpiar localStorage del navegador
# Abrir DevTools > Application > Local Storage > Clear
```

### Website themes no aparecen en la UI tradicional

```bash
# 1. Verificar migraci√≥n
bench --site mi-sitio migrate --verbose

# 2. Reinstalar fixtures
bench --site mi-sitio install-fixtures

# 3. Limpiar cach√©
bench --site mi-sitio clear-cache
```

### Error de instalaci√≥n

```bash
# Verificar permisos
ls -la apps/mi_app/mi_app/

# Verificar que la app existe
bench --site mi-sitio list-apps

# Reinstalar desde cero si es necesario
./install.sh mi_app
```

### Restaurar archivos originales de Frappe

```bash
# Si algo sale mal, restaurar backups
cp sites/assets/frappe/js/frappe/desk.js.original sites/assets/frappe/js/frappe/desk.js
cp sites/assets/frappe/js/frappe/ui/theme_switcher.js.original sites/assets/frappe/js/frappe/ui/theme_switcher.js

# Reconstruir
bench build --app frappe
```

## üöÄ Uso despu√©s de la Instalaci√≥n

### Cambio R√°pido de Temas (Recomendado)
1. **Usar Theme Switcher Mejorado:**
   - Presiona `Ctrl+Shift+G` desde cualquier parte del desk
   - Ve previews visuales de todos los temas disponibles
   - Haz clic en cualquier tema para aplicarlo instant√°neamente
   - Tu selecci√≥n se guarda autom√°ticamente

### Gesti√≥n Tradicional de Website Themes
1. **Acceder a los website themes:**
   ```
   Setup > Website > Website Theme
   ```

2. **Los website themes aparecer√°n como:**
   - Dickface
   - Dickhead

3. **Seleccionar y configurar:**
   - Haz clic en el tema deseado
   - Ajusta las opciones (botones, sombras, etc.)
   - Guarda los cambios

### Temas de Desk Disponibles
- **Frappe Light**: Tema claro por defecto
- **Timeless Night**: Tema oscuro elegante
- **Automatic**: Se adapta al tema del sistema
- **Dark Purple Desk**: Tema p√∫rpura personalizado üÜï
- **Ocean Blue Desk**: Tema azul con gradientes üÜï

## üîß Funcionalidades Avanzadas

### Theme Preview API
```javascript
// Obtener todos los temas con datos de preview
frappe.xcall('tu_app.theme_preview_api.get_theme_preview_data')
  .then(response => console.log(response.themes));

// Validar que la API funciona
frappe.xcall('tu_app.theme_preview_api.validate_theme_preview_api')
  .then(result => console.log(result));
```

### Gesti√≥n de Preferencias
```javascript
// Guardar tema preferido
frappe.xcall('tu_app.user_extension.save_desk_theme_preference', {
  theme_name: 'dark_purple_desk'
});

// Obtener tema preferido
frappe.xcall('tu_app.user_extension.get_desk_theme_preference')
  .then(result => console.log(result.theme));
```

## üîß Personalizaci√≥n Avanzada

### Modificar un tema existente

```bash
# 1. Editar el archivo JSON del tema
nano apps/mi_app/mi_app/website_theme/dickface/dickface.json

# 2. Personalizar el SCSS
# Edita el campo "theme_scss" en el JSON

# 3. Compilar assets
bench build --app mi_app
```

### Agregar un nuevo tema

```bash
# 1. Crear directorio para el nuevo tema
mkdir themes/mi_nuevo_tema

# 2. Crear archivo JSON
cat > themes/mi_nuevo_tema/mi_nuevo_tema.json << EOF
{
  "doctype": "Website Theme",
  "name": "Mi Nuevo Tema",
  "theme": "Mi Nuevo Tema", 
  "module": "Tu App",
  "theme_scss": "// Tu CSS aqu√≠"
}
EOF

# 3. Crear __init__.py
touch themes/mi_nuevo_tema/__init__.py

# 4. Actualizar fixtures
# Editar fixtures/website_theme.json para incluir el nuevo tema

# 5. Reinstalar
./install.sh mi_app
```

## üìù Ejemplo de Integraci√≥n

### En tu aplicaci√≥n Frappe:

```python
# hooks.py despu√©s de la instalaci√≥n
fixtures = [
    {
        "doctype": "Website Theme",
        "filters": [
            ["name", "in", ["Dickface", "Dickhead"]]
        ]
    }
]
```

### Estructura resultante en tu app:

```
apps/mi_app/
‚îú‚îÄ‚îÄ mi_app/
‚îÇ   ‚îú‚îÄ‚îÄ website_theme/              # ‚Üê Todos los temas instalados aqu√≠
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dickface/               # Website theme
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dickhead/               # Website theme  
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dark_purple_desk/       # Desk theme üÜï
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ocean_blue_desk/        # Desk theme üÜï
‚îÇ   ‚îú‚îÄ‚îÄ fixtures/                   # ‚Üê Fixtures con configuraci√≥n autom√°tica
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ website_theme.json
‚îÇ   ‚îú‚îÄ‚îÄ theme_preview_api.py        # ‚Üê API de previews üÜï
‚îÇ   ‚îú‚îÄ‚îÄ user_extension.py           # ‚Üê Gesti√≥n de preferencias üÜï
‚îÇ   ‚îú‚îÄ‚îÄ hooks.py                    # ‚Üê Actualizado autom√°ticamente
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py                 # ‚Üê Imports agregados autom√°ticamente

# Archivos de Frappe mejorados:
sites/assets/frappe/js/frappe/
‚îú‚îÄ‚îÄ desk.js                         # ‚Üê Con auto-loader integrado üÜï
‚îî‚îÄ‚îÄ ui/theme_switcher.js           # ‚Üê Theme switcher enhanced üÜï

# Backups autom√°ticos creados:
sites/assets/frappe/js/frappe/
‚îú‚îÄ‚îÄ desk.js.original               # ‚Üê Backup del original
‚îî‚îÄ‚îÄ ui/theme_switcher.js.original  # ‚Üê Backup del original
```

## ü§ù Contribuir

1. Fork este repositorio
2. Crea una rama: `git checkout -b nueva-feature`
3. Haz tus cambios
4. Commit: `git commit -am 'Agregar nueva feature'`
5. Push: `git push origin nueva-feature`
6. Crea un Pull Request

## ÔøΩ Documentaci√≥n Adicional

- **[Theme Preview API](THEME_PREVIEW_API.md)**: Documentaci√≥n completa de la API de previews
- **Endpoints disponibles**: `get_theme_preview_data`, `validate_theme_preview_api`
- **Integraci√≥n JavaScript**: Ejemplos de uso en el frontend
- **Extracci√≥n de colores**: Algoritmos de an√°lisis CSS autom√°tico

## üîÑ Restauraci√≥n y Mantenimiento

### Actualizar el sistema de temas
```bash
# Actualizar subm√≥dulo
git submodule update --remote frappe-themes-submodule

# Reinstalar con nuevas funcionalidades
./frappe-themes-submodule/install.sh mi_app
bench build --app frappe
bench --site mi-sitio clear-cache
```

### Agregar nuevos temas desk personalizados
```bash
# 1. Crear directorio del tema
mkdir themes/mi_tema_desk

# 2. Crear archivo JSON con css_content
cat > themes/mi_tema_desk/mi_tema_desk.json << 'EOF'
{
  "name": "Mi Tema Desk",
  "theme": "Mi Tema Desk", 
  "module": "Website",
  "css_content": "/* CSS para el desk aqu√≠ */"
}
EOF

# 3. Reinstalar
./install.sh mi_app
```

## ‚ö° Caracter√≠sticas T√©cnicas

### Theme Switcher Enhanced
- **Previews en tiempo real**: Generaci√≥n autom√°tica de previews visuales
- **Detecci√≥n de temas**: Sistema inteligente de detecci√≥n de temas personalizados
- **Aplicaci√≥n instant√°nea**: Sin necesidad de refrescar p√°gina
- **Persistencia robusta**: M√∫ltiples m√©todos de almacenamiento de preferencias

### Auto-Loader System
- **Carga autom√°tica**: Restaura tema preferido al iniciar sesi√≥n
- **Fallback inteligente**: Sistema robusto de recuperaci√≥n ante errores
- **Multi-app support**: Funciona con cualquier app de Frappe
- **Cache management**: Optimizaci√≥n de rendimiento y memoria

### Theme Preview API
- **Extracci√≥n inteligente**: An√°lisis autom√°tico de CSS y variables
- **Mapeo de componentes**: Colores espec√≠ficos para navbar, sidebar, etc.
- **Validaci√≥n robusta**: Sistema completo de validaci√≥n de colores
- **Error handling**: Manejo robusto de errores con fallbacks

## ÔøΩüìÑ Licencia

MIT License - √ösalo libremente en tus proyectos.

## üÜò Soporte

- **Issues**: [GitHub Issues del repositorio]
- **Documentaci√≥n**: [THEME_PREVIEW_API.md](THEME_PREVIEW_API.md)
- **Community**: [Foro de Frappe]

---

**üí° Tips Importantes**:
- Usa `Ctrl+Shift+G` para cambiar temas r√°pidamente
- Los temas se guardan autom√°ticamente por usuario
- Los backups de archivos originales se crean autom√°ticamente
- Mant√©n este repositorio como subm√≥dulo para recibir actualizaciones